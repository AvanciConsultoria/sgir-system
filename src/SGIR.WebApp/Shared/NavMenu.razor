<div class="nav-menu">
    <!-- Dashboard -->
    <div class="nav-section">
        <a href="/" class="nav-item @GetActiveClass("")">
            <span class="nav-icon">ğŸ“Š</span>
            <span>Dashboard</span>
        </a>
    </div>

    <!-- Cadastros -->
    <div class="nav-section">
        <div class="nav-section-title">Cadastros</div>
        <a href="/projetos" class="nav-item @GetActiveClass("projetos")">
            <span class="nav-icon">ğŸ“‹</span>
            <span>Projetos</span>
        </a>
        <a href="/colaboradores" class="nav-item @GetActiveClass("colaboradores")">
            <span class="nav-icon">ğŸ‘¥</span>
            <span>Colaboradores</span>
        </a>
        <a href="/certificacoes" class="nav-item @GetActiveClass("certificacoes")">
            <span class="nav-icon">ğŸ“œ</span>
            <span>CertificaÃ§Ãµes</span>
        </a>
    </div>

    <!-- Recursos -->
    <div class="nav-section">
        <div class="nav-section-title">Recursos</div>
        <a href="/recursos" class="nav-item @GetActiveClass("recursos")">
            <span class="nav-icon">ğŸ”§</span>
            <span>Recursos NecessÃ¡rios</span>
        </a>
        <a href="/alocacoes" class="nav-item @GetActiveClass("alocacoes")">
            <span class="nav-icon">ğŸ“Œ</span>
            <span>AlocaÃ§Ãµes</span>
        </a>
    </div>

    <!-- Estoque -->
    <div class="nav-section">
        <div class="nav-section-title">Estoque</div>
        <a href="/ferramentas" class="nav-item @GetActiveClass("ferramentas")">
            <span class="nav-icon">ğŸ”¨</span>
            <span>Ferramentas</span>
        </a>
        <a href="/caixas" class="nav-item @GetActiveClass("caixas")">
            <span class="nav-icon">ğŸ“¦</span>
            <span>Caixas</span>
        </a>
        <a href="/carrinhos" class="nav-item @GetActiveClass("carrinhos")">
            <span class="nav-icon">ğŸ›’</span>
            <span>Carrinhos</span>
        </a>
        <a href="/movimentos" class="nav-item @GetActiveClass("movimentos")">
            <span class="nav-icon">ğŸ“Š</span>
            <span>MovimentaÃ§Ãµes</span>
        </a>
    </div>

    <!-- Compras -->
    <div class="nav-section">
        <div class="nav-section-title">Compras</div>
        <a href="/analises" class="nav-item @GetActiveClass("analises")">
            <span class="nav-icon">ğŸ“ˆ</span>
            <span>AnÃ¡lise de DÃ©ficit</span>
            @if (HasPendingAnalysis())
            {
                <span class="nav-badge">!</span>
            }
        </a>
        <a href="/compras" class="nav-item @GetActiveClass("compras")">
            <span class="nav-icon">ğŸ›ï¸</span>
            <span>Compras AutomÃ¡ticas</span>
            @if (PendingPurchases > 0)
            {
                <span class="nav-badge">@PendingPurchases</span>
            }
        </a>
    </div>

    <!-- Custos -->
    <div class="nav-section">
        <div class="nav-section-title">Financeiro</div>
        <a href="/custos" class="nav-item @GetActiveClass("custos")">
            <span class="nav-icon">ğŸ’°</span>
            <span>Custos Operacionais</span>
        </a>
    </div>

    <!-- Ferramentas -->
    <div class="nav-section">
        <div class="nav-section-title">Ferramentas</div>
        <a href="/importar" class="nav-item @GetActiveClass("importar")">
            <span class="nav-icon">ğŸ“¤</span>
            <span>Importar Excel</span>
        </a>
        <a href="/gap-analysis" class="nav-item @GetActiveClass("gap-analysis")">
            <span class="nav-icon">ğŸ“Š</span>
            <span>GAP Analysis</span>
        </a>
    </div>

    <!-- ConfiguraÃ§Ãµes -->
    <div class="nav-section">
        <div class="nav-section-title">Sistema</div>
        <a href="/usuarios" class="nav-item @GetActiveClass("usuarios")">
            <span class="nav-icon">ğŸ‘¤</span>
            <span>UsuÃ¡rios</span>
        </a>
    </div>
</div>

@code {
    [Inject] private NavigationManager? NavigationManager { get; set; }
    
    private int PendingPurchases = 0;
    
    private string GetActiveClass(string page)
    {
        if (NavigationManager == null) return "";
        
        var currentPath = new Uri(NavigationManager.Uri).AbsolutePath.TrimStart('/');
        
        if (string.IsNullOrEmpty(page) && string.IsNullOrEmpty(currentPath))
            return "active";
        
        if (!string.IsNullOrEmpty(page) && currentPath.StartsWith(page, StringComparison.OrdinalIgnoreCase))
            return "active";
        
        return "";
    }
    
    private bool HasPendingAnalysis()
    {
        // TODO: Implement logic to check for pending analysis
        return false;
    }
    
    protected override async Task OnInitializedAsync()
    {
        // TODO: Load pending purchases count from database
        await Task.CompletedTask;
    }
}
